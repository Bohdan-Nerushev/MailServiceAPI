# –ü–ª–∞–Ω —Ä–æ–∑—Ä–æ–±–∫–∏ Mail Service API (FastAPI)

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑—É—î –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø–æ—à—Ç–æ–≤–∏–º —Å–µ—Ä–≤–µ—Ä–æ–º (Postfix/Dovecot) —á–µ—Ä–µ–∑ REST API.

---

## üü¢ –§–∞–∑–∞ 1: –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ç–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
- [x] **–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É —á–µ—Ä–µ–∑ Poetry**:
    - `poetry init`
    - –î–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π: `fastapi`, `uvicorn`, `aiosmtplib`, `imap_tools`, `python-dotenv`.
- [x] **–°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø–∞–ø–æ–∫**:
    - `app/main.py` (—Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É)
    - `app/services/` (–ª–æ–≥—ñ–∫–∞ SMTP, IMAP, Linux Users)
    - `app/routes/` (–µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ API)
    - `.env` (–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —Å–µ—Ä–≤–µ—Ä—ñ–≤ —Ç–∞ –ø–æ—Ä—Ç—ñ–≤)
- [x] **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è "Hello World"**:
    - –ë–∞–∑–æ–≤–∏–π –∑–∞–ø—É—Å–∫ FastAPI —Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø—É –¥–æ `/docs` (Swagger).

---

## üîµ –§–∞–∑–∞ 2: –ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ (Subprocess)
*–ú–µ—Ç–∞: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –∫–æ–Ω—Å–æ–ª—å–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ `useradd`, `passwd` —Ç–æ—â–æ.*
- [x] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥—É–ª—è `services/user_manager.py`.
- [x] –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–π —á–µ—Ä–µ–∑ `subprocess.run`:
    - `create_system_user(username, password)`
    - `delete_system_user(username)`
    - `change_user_password(username, new_password)`
- [x] **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Sudo**: 
    - –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–∞–≤ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤—ñ–¥ —è–∫–æ–≥–æ –ø—Ä–∞—Ü—é—î API, –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ –±–µ–∑ –ø–∞—Ä–æ–ª—è (`visudo`).

---

## üü° –§–∞–∑–∞ 3: –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ø–æ—à—Ç–∏ (SMTP + aiosmtplib)
*–ú–µ—Ç–∞: –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω–∏–π Postfix.*
- [x] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥—É–ª—è `services/smtp_service.py`.
- [x] –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∫–ª—ñ—î–Ω—Ç–∞ `aiosmtplib`.
- [x] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞ `POST /mail/send`:
    - –ü—Ä–∏–π–æ–º JSON (to, subject, body).
    - –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ Pydantic.

---

## üü£ –§–∞–∑–∞ 4: –ß–∏—Ç–∞–Ω–Ω—è –ø–æ—à—Ç–∏ (IMAP + imap_tools)
*–ú–µ—Ç–∞: –¥–æ—Å—Ç—É–ø –¥–æ –ø–æ—à—Ç–æ–≤–∏—Ö —Å–∫—Ä–∏–Ω—å–æ–∫ —á–µ—Ä–µ–∑ Dovecot.*
- [x] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–æ–¥—É–ª—è `services/imap_service.py`.
- [x] –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ `localhost` —á–µ—Ä–µ–∑ `imap_tools`.
- [x] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –µ–Ω–¥–ø–æ—ñ–Ω—Ç—ñ–≤:
    - `GET /mail/inbox/{username}` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –ª–∏—Å—Ç—ñ–≤.
    - `GET /mail/message/{id}` ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞.

---

## üî¥ –§–∞–∑–∞ 5: –ë–µ–∑–ø–µ–∫–∞ —Ç–∞ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- [x] **–õ–æ–≥—É–≤–∞–Ω–Ω—è**:
    - –ó–∞–ø–∏—Å —É—Å—ñ—Ö –¥—ñ–π (—Ö—Ç–æ, –∫–æ–ª–∏ —ñ –∫–æ–º—É –≤—ñ–¥–ø—Ä–∞–≤–∏–≤ –ª–∏—Å—Ç) —É –ª–æ–≥-—Ñ–∞–π–ª.

---

## üèÅ –§–∞–∑–∞ 6: –§—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- [ ] –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ø–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª—É: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —é–∑–µ—Ä–∞ -> –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç–∞ -> –ß–∏—Ç–∞–Ω–Ω—è –ª–∏—Å—Ç–∞ (–≤—Å–µ —á–µ—Ä–µ–∑ Swagger).
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–Ω—è `systemd` —Å–µ—Ä–≤—ñ—Å—É –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫—É API —Ä–∞–∑–æ–º —ñ–∑ —Å–µ—Ä–≤–µ—Ä–æ–º.
